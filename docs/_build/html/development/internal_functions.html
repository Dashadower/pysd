

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Internal Functions &mdash; PySD 1.1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Complementary Projects" href="complement.html" />
    <link rel="prev" title="XMILE Translation" href="xmile_translation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> PySD
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_usage.html">Basic Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced_usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">User Functions Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="development_index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="about.html">About the Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing to PySD</a></li>
<li class="toctree-l2"><a class="reference internal" href="pathway.html">PySD Development Pathway</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="structure.html">Structure of the PySD module</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="structure.html#translation">Translation</a></li>
<li class="toctree-l3"><a class="reference internal" href="structure.html#the-model-class">The model class</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="structure.html#the-pysd-class">The PySD class</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Internal Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="complement.html">Complementary Projects</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PySD</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="development_index.html">Developer Documentation</a> &raquo;</li>
        
          <li><a href="structure.html">Structure of the PySD module</a> &raquo;</li>
        
      <li>Internal Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/development/internal_functions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="internal-functions">
<h1>Internal Functions<a class="headerlink" href="#internal-functions" title="Permalink to this headline">¶</a></h1>
<p>This section documents the functions that are going on behaind the scenes, for the benefit of developers.</p>
<div class="section" id="module-py_backend.utils">
<span id="special-functions-needed-for-model-execution"></span><h2>Special functions needed for model execution<a class="headerlink" href="#module-py_backend.utils" title="Permalink to this headline">¶</a></h2>
<p>These are general utilities used by the builder.py, functions.py or the
model file. Vensim’s function equivalents should not go here but in
functions.py</p>
<dl class="py function">
<dt id="py_backend.utils.add_entries_underscore">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">add_entries_underscore</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">dictionaries</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#add_entries_underscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.add_entries_underscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Expands dictionaries adding new keys underscoring the white spaces
in the old ones. As the dictionaries are mutable objects this functions
will add the new entries to the already existing dictionaries with
no need to return a new one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*dictionaries</strong> (<em>Dictionary</em><em> or </em><em>dictionaries</em>) – The dictionary or dictionaries to add the entries with underscore.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.compute_shape">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">compute_shape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">reshape_len</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">py_name</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#compute_shape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.compute_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the ‘shape’ of a coords dictionary.
Function used to rearange data in xarrays and
to compute the number of rows/columns to be read in a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Ordered dictionary of the dimension names as a keys with their values.</p></li>
<li><p><strong>reshape_len</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> (</em><em>optional</em><em>)</em>) – Number of dimensions of the output shape.
The shape will ony compute the corresponent table
dimensions to read from Excel, then, the dimensions
with length one will be ignored at first.
Lately, it will complete with 1 on the left of the shape
if the reshape_len value is bigger than the length of shape.
Will raise a ValueError if we try to reshape to a reshape_len
smaller than the initial shape.</p></li>
<li><p><strong>py_name</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Name to print if an error is raised.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>shape</strong> – Shape of the ordered dictionary or of the desired table or vector</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dictionaries in Python &gt;= 3.7 are ordered, which means that
we could remove dims if there is a not backward compatible
version of the library which only works in Python 3.7+. For now,
the dimensions list is passed to make it work properly for all the users.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.ddir">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">ddir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#py_backend.utils.ddir" title="Permalink to this definition">¶</a></dt>
<dd><p>__dir__() -&gt; list
specialized dir() implementation</p>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.edir">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">edir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#py_backend.utils.edir" title="Permalink to this definition">¶</a></dt>
<dd><p>__dir__() -&gt; list
specialized dir() implementation</p>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.fdir">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">fdir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#py_backend.utils.fdir" title="Permalink to this definition">¶</a></dt>
<dd><p>__dir__() -&gt; list
specialized dir() implementation</p>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.find_subscript_name">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">find_subscript_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subscript_dict</span></em>, <em class="sig-param"><span class="n">element</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#find_subscript_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.find_subscript_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a subscript dictionary, and a member of a subscript family,
return the first key of which the member is within the value list.
If element is already a subscript name, return that</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subscript_dict</strong> (<em>dictionary</em>) – Follows the {‘subscript name’:[‘list’,’of’,’subscript’,’elements’]} format</p></li>
<li><p><strong>element</strong> (<em>string</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Examples</em></p></li>
<li><p><strong>&gt;&gt;&gt; find_subscript_name({‘Dim1’</strong> (<em>[‘A’, ‘B’],</em>)</p></li>
<li><p><strong>…                      ‘Dim2’</strong> (<em>[‘C’, ‘D’, ‘E’],</em>)</p></li>
<li><p><strong>…                      ‘Dim3’</strong> (<em>[‘F’, ‘G’, ‘H’, ‘I’]},</em>)</p></li>
<li><p><em>…                      ‘D’)</em></p></li>
<li><p><em>’Dim2’</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.get_return_elements">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">get_return_elements</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">return_columns</span></em>, <em class="sig-param"><span class="n">namespace</span></em>, <em class="sig-param"><span class="n">subscript_dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#get_return_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.get_return_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of return elements formatted in vensim’s format
Varname[Sub1, SUb2]
and returns first the model elements (in python safe language)
that need to be computed and collected, and secondly the addresses
that each element in the return columns list translates to</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>return_columns</strong> (<em>list of strings</em>) – </p></li>
<li><p><strong>namespace</strong> – </p></li>
<li><p><strong>subscript_dict</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>capture_elements</em></p></li>
<li><p><em>return_addresses</em></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.get_value_by_insensitive_key_or_value">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">get_value_by_insensitive_key_or_value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#get_value_by_insensitive_key_or_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.get_value_by_insensitive_key_or_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="py_backend.utils.make_add_identifier">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">make_add_identifier</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">identifier</span></em>, <em class="sig-param"><span class="n">build_names</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#make_add_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.make_add_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an existing used Python identifier and attatch a unique
identifier with ADD_# ending.</p>
<p>Used for add new information to an existing external object.
build_names will be updated inside this functions as a set
is mutable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<em>&lt;basestring&gt;</em>) – Existing python identifier</p></li>
<li><p><strong>build_names</strong> (<em>&lt;set&gt;</em>) – Set of the already used identifiers for external objects.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>identifier</strong> – A vaild python identifier based on the input indentifier
and the existing ones</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>&lt;string&gt;</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.make_coord_dict">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">make_coord_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subs</span></em>, <em class="sig-param"><span class="n">subscript_dict</span></em>, <em class="sig-param"><span class="n">terse</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#make_coord_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.make_coord_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>This is for assisting with the lookup of a particular element, such that
the output of this function would take the place of %s in this expression</p>
<p><cite>variable.loc[%s]</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subs</strong> (<em>list of strings</em>) – coordinates, either as names of dimensions, or positions within
a dimension</p></li>
<li><p><strong>subscript_dict</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – the full dictionary of subscript names and values</p></li>
<li><p><strong>terse</strong> (<em>Binary Flag</em>) – <ul>
<li><p>If true, includes only elements that do not cover the full range of
values in their respective dimension</p></li>
<li><p>If false, returns all dimensions</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coordinates</strong> – Coordinates needed to access the xarray quantities we’re interested in.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_coord_dict</span><span class="p">([</span><span class="s1">&#39;Dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;Dim1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;Dim2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">]})</span>
<span class="go">{&#39;Dim2&#39;: [&#39;D&#39;]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">make_coord_dict</span><span class="p">([</span><span class="s1">&#39;Dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;Dim1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">],</span> <span class="s1">&#39;Dim2&#39;</span><span class="p">:[</span><span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">]},</span>
<span class="gp">&gt;&gt;&gt; </span>                <span class="n">terse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">{&#39;Dim2&#39;: [&#39;D&#39;], &#39;Dim1&#39;: [&#39;A&#39;, &#39;B&#39;, &#39;C&#39;]}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.make_flat_df">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">make_flat_df</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frames</span></em>, <em class="sig-param"><span class="n">return_addresses</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#make_flat_df"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.make_flat_df" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes a list of dictionaries, each representing what is returned from the
model at a particular time, and creates a dataframe whose columns
correspond to the keys of <cite>return addresses</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> (<em>list of dictionaries</em>) – each dictionary represents the result of a prticular time in the model</p></li>
<li><p><strong>return_addresses</strong> (<em>a dictionary</em><em>,</em>) – keys will be column names of the resulting dataframe, and are what the
user passed in as ‘return_columns’. Values are a tuple:
(py_name, {coords dictionary}) which tells us where to look for the
value to put in that specific column.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.make_python_identifier">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">make_python_identifier</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string</span></em>, <em class="sig-param"><span class="n">namespace</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reserved_words</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">convert</span><span class="o">=</span><span class="default_value">'drop'</span></em>, <em class="sig-param"><span class="n">handle</span><span class="o">=</span><span class="default_value">'force'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#make_python_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.make_python_identifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes an arbitrary string and creates a valid Python identifier.</p>
<p>If the input string is in the namespace, return its value.</p>
<p>If the python identifier created is already in the namespace,
but the input string is not (ie, two similar strings resolve to
the same python identifier)</p>
<p>or if the identifier is a reserved word in the reserved_words
list, or is a python default reserved word,
adds _1, or if _1 is in the namespace, _2, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<em>&lt;basestring&gt;</em>) – The text to be converted into a valid python identifier</p></li>
<li><p><strong>namespace</strong> (<em>&lt;dictionary&gt;</em>) – Map of existing translations into python safe identifiers.
This is to ensure that two strings are not translated into
the same python identifier</p></li>
<li><p><strong>reserved_words</strong> (<em>&lt;list of strings&gt;</em>) – List of words that are reserved (because they have other meanings
in this particular program, such as also being the names of
libraries, etc.</p></li>
<li><p><strong>convert</strong> (<em>&lt;string&gt;</em>) – <p>Tells the function what to do with characters that are not
valid in python identifiers
- ‘hex’ implies that they will be converted to their hexidecimal</p>
<blockquote>
<div><p>representation. This is handy if you have variables that
have a lot of reserved characters, or you don’t want the
name to be dependent on when things were added to the
namespace</p>
</div></blockquote>
<ul>
<li><p>’drop’ implies that they will just be dropped altogether</p></li>
</ul>
</p></li>
<li><p><strong>handle</strong> (<em>&lt;string&gt;</em>) – <p>Tells the function how to deal with namespace conflicts
- ‘force’ will create a representation which is not in conflict</p>
<blockquote>
<div><p>by appending _n to the resulting variable where n is
the lowest number necessary to avoid a conflict</p>
</div></blockquote>
<ul>
<li><p>’throw’ will raise an exception</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>identifier</strong> (<em>&lt;string&gt;</em>) – A vaild python identifier based on the input string</p></li>
<li><p><strong>namespace</strong> (<em>&lt;dictionary&gt;</em>) – An updated map of the translations of words to python identifiers,
including the passed in ‘string’.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_python_identifier</span><span class="p">(</span><span class="s1">&#39;Capital&#39;</span><span class="p">)</span>
<span class="go">(&#39;capital&#39;, {&#39;Capital&#39;: &#39;capital&#39;})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_python_identifier</span><span class="p">(</span><span class="s1">&#39;multiple words&#39;</span><span class="p">)</span>
<span class="go">(&#39;multiple_words&#39;, {&#39;multiple words&#39;: &#39;multiple_words&#39;})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_python_identifier</span><span class="p">(</span><span class="s1">&#39;multiple     spaces&#39;</span><span class="p">)</span>
<span class="go">(&#39;multiple_spaces&#39;, {&#39;multiple     spaces&#39;: &#39;multiple_spaces&#39;})</span>
</pre></div>
</div>
<p>When the name is a python keyword, add ‘_1’ to differentiate it
&gt;&gt;&gt; make_python_identifier(‘for’)
(‘for_1’, {‘for’: ‘for_1’})</p>
<p>Remove leading and trailing whitespace
&gt;&gt;&gt; make_python_identifier(‘  whitespace  ‘)
(‘whitespace’, {‘  whitespace  ‘: ‘whitespace’})</p>
<p>Remove most special characters outright:
&gt;&gt;&gt; make_python_identifier(‘H&#64;t tr!ck’)
(‘ht_trck’, {‘H&#64;t tr!ck’: ‘ht_trck’})</p>
<p>Replace special characters with their hex representations
&gt;&gt;&gt; make_python_identifier(‘H&#64;t tr!ck’, convert=’hex’)
(‘h40t_tr21ck’, {‘H&#64;t tr!ck’: ‘h40t_tr21ck’})</p>
<p>remove leading digits
&gt;&gt;&gt; make_python_identifier(‘123abc’)
(‘abc’, {‘123abc’: ‘abc’})</p>
<p>already in namespace
&gt;&gt;&gt; make_python_identifier(‘Variable$’, namespace={‘Variable$’: ‘variable’})
(‘variable’, {‘Variable$’: ‘variable’})</p>
<p>namespace conflicts
&gt;&gt;&gt; make_python_identifier(‘Variable$’, namespace={‘Variable&#64;’: ‘variable’})
(‘variable_1’, {‘Variable&#64;’: ‘variable’, ‘Variable$’: ‘variable_1’})</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">make_python_identifier</span><span class="p">(</span><span class="s1">&#39;Variable$&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Variable@&#39;</span><span class="p">:</span> <span class="s1">&#39;variable&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                               <span class="s1">&#39;Variable%&#39;</span><span class="p">:</span> <span class="s1">&#39;variable_1&#39;</span><span class="p">})</span>
<span class="go">(&#39;variable_2&#39;, {&#39;Variable@&#39;: &#39;variable&#39;, &#39;Variable%&#39;: &#39;variable_1&#39;, &#39;Variable$&#39;: &#39;variable_2&#39;})</span>
</pre></div>
</div>
<p>throw exception instead
&gt;&gt;&gt; make_python_identifier(‘Variable$’, namespace={‘Variable&#64;’: ‘variable’}, handle=’throw’)
Traceback (most recent call last):</p>
<blockquote>
<div><p>…</p>
</div></blockquote>
<p>NameError: variable already exists in namespace or is a reserved word</p>
<p class="rubric">References</p>
<dl class="simple">
<dt>Identifiers must follow the convention outlined here:</dt><dd><p><a class="reference external" href="https://docs.python.org/2/reference/lexical_analysis.html#identifiers">https://docs.python.org/2/reference/lexical_analysis.html#identifiers</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.rearrange">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">rearrange</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">dims</span></em>, <em class="sig-param"><span class="n">coords</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#rearrange"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.rearrange" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a xarray.DataArray object with the given coords and dims</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a><em> or </em><em>xarray.DataArray</em>) – The input data to rearrange.</p></li>
<li><p><strong>dims</strong> (<em>list</em>) – Ordered list of the dimensions.</p></li>
<li><p><strong>coords</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/stdtypes.html#dict" title="(in Python v2.7)"><em>dict</em></a>) – Dictionary of the dimension names as a keys with their values.</p></li>
<li><p><strong>switch</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#bool" title="(in Python v2.7)"><em>bool</em></a>) – Flag to denote if the dimensions can be switched. Default True,
The False is used to rearrange general expressions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.round_">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">round_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#round_"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.round_" title="Permalink to this definition">¶</a></dt>
<dd><p>Redefinition of round function to make it work with floats and xarrays</p>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.visit_addresses">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">visit_addresses</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">frame</span></em>, <em class="sig-param"><span class="n">return_addresses</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#visit_addresses"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.visit_addresses" title="Permalink to this definition">¶</a></dt>
<dd><p>Visits all of the addresses, returns a new dict
which contains just the addressed elements</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> – </p></li>
<li><p><strong>return_addresses</strong> (<em>a dictionary</em><em>,</em>) – keys will be column names of the resulting dataframe, and are what the
user passed in as ‘return_columns’. Values are a tuple:
(py_name, {coords dictionary}) which tells us where to look for the
value to put in that specific column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>outdict</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="py_backend.utils.xrmerge">
<code class="sig-prename descclassname">py_backend.utils.</code><code class="sig-name descname">xrmerge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">das</span></em>, <em class="sig-param"><span class="n">accept_new</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/utils.html#xrmerge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.utils.xrmerge" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges xarrays with different dimension sets
:param das:
:type das: list of data_arrays
:param accept_new:</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>da</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>an xarray that is the merge of das</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Thanks to &#64;jcmgray <a class="reference external" href="https://github.com/pydata/xarray/issues/742#issue-130753818">https://github.com/pydata/xarray/issues/742#issue-130753818</a></p>
<p>In the future, we may not need this as xarray may provide the merge for us.</p>
</dd></dl>

</div>
<div class="section" id="building-the-python-model-file">
<h2>Building the python model file<a class="headerlink" href="#building-the-python-model-file" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-py_backend.external">
<span id="external-data-reading"></span><h2>External data reading<a class="headerlink" href="#module-py_backend.external" title="Permalink to this headline">¶</a></h2>
<p>These classes are a collection of the needed tools to read external data.
The External type objects created by these classes are initialized before
the Stateful objects by functions.Model.initialize.</p>
<dl class="py class">
<dt id="py_backend.external.Excels">
<em class="property">class </em><code class="sig-prename descclassname">py_backend.external.</code><code class="sig-name descname">Excels</code><a class="reference internal" href="../_modules/py_backend/external.html#Excels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.Excels" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to save the read Excel files and thus avoid double reading</p>
<dl class="py attribute">
<dt id="py_backend.external.Excels._Excels">
<code class="sig-name descname">_Excels</code><em class="property"> = {}</em><a class="headerlink" href="#py_backend.external.Excels._Excels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="py_backend.external.Excels._Excels_opyxl">
<code class="sig-name descname">_Excels_opyxl</code><em class="property"> = {}</em><a class="headerlink" href="#py_backend.external.Excels._Excels_opyxl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="py_backend.external.Excels.clean">
<em class="property">classmethod </em><code class="sig-name descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#Excels.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.Excels.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Clean the dictionary of read files</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.Excels.read">
<em class="property">classmethod </em><code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#Excels.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.Excels.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the Excel file or return the previously read one</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.Excels.read_opyxl">
<em class="property">classmethod </em><code class="sig-name descname">read_opyxl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#Excels.read_opyxl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.Excels.read_opyxl" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the Excel file using OpenPyXL or return the previously read one</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="py_backend.external.ExtConstant">
<em class="property">class </em><code class="sig-prename descclassname">py_backend.external.</code><code class="sig-name descname">ExtConstant</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">py_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtConstant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtConstant" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for Vensim GET XLS CONSTANTS/GET DIRECT CONSTANTS</p>
<dl class="py method">
<dt id="py_backend.external.ExtConstant._get_constant_data">
<code class="sig-name descname">_get_constant_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_across</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">shape</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtConstant._get_constant_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtConstant._get_constant_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function thar reads data from excel file for CONSTANT</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_across</strong> (<em>&quot;cell&quot;</em><em> or </em><em>&quot;name&quot;</em>) – The way to read data file.</p></li>
<li><p><strong>cell</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – If data_across is “cell” the lefttop split cell value where
the data is.
If data_across is “name” the cell range name where the data is.</p></li>
<li><p><strong>shape</strong> – The shape of the data in 2D.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – The values of the data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float/ndarray(1D/2D)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.ExtConstant._initialize">
<code class="sig-name descname">_initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtConstant._initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtConstant._initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize one element</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.ExtConstant.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">coords</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtConstant.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtConstant.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add information to retrieve new dimension in an already declared object</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.ExtConstant.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtConstant.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtConstant.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize all elements and create the self.data xarray.DataArray</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="py_backend.external.ExtData">
<em class="property">class </em><code class="sig-prename descclassname">py_backend.external.</code><code class="sig-name descname">ExtData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet</span></em>, <em class="sig-param"><span class="n">time_row_or_col</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">interp</span></em>, <em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">py_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtData" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for Vensim GET XLS DATA/GET DIRECT DATA</p>
<dl class="py method">
<dt id="py_backend.external.ExtData.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet</span></em>, <em class="sig-param"><span class="n">time_row_or_col</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">interp</span></em>, <em class="sig-param"><span class="n">coords</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtData.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtData.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add information to retrieve new dimension in an already declared object</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.ExtData.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtData.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtData.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize all elements and create the self.data xarray.DataArray</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="py_backend.external.ExtLookup">
<em class="property">class </em><code class="sig-prename descclassname">py_backend.external.</code><code class="sig-name descname">ExtLookup</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet</span></em>, <em class="sig-param"><span class="n">x_row_or_col</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">root</span></em>, <em class="sig-param"><span class="n">py_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtLookup"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtLookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for Vensim GET XLS LOOKUPS/GET DIRECT LOOKUPS</p>
<dl class="py method">
<dt id="py_backend.external.ExtLookup.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet</span></em>, <em class="sig-param"><span class="n">x_row_or_col</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">coords</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtLookup.add"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtLookup.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add information to retrieve new dimension in an already declared object</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.ExtLookup.initialize">
<code class="sig-name descname">initialize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtLookup.initialize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtLookup.initialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize all elements and create the self.data xarray.DataArray</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="py_backend.external.ExtSubscript">
<em class="property">class </em><code class="sig-prename descclassname">py_backend.external.</code><code class="sig-name descname">ExtSubscript</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em>, <em class="sig-param"><span class="n">sheet</span></em>, <em class="sig-param"><span class="n">firstcell</span></em>, <em class="sig-param"><span class="n">lastcell</span></em>, <em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="n">root</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#ExtSubscript"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.ExtSubscript" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for Vensim GET XLS SUBSCRIPT/GET DIRECT SUBSCRIPT</p>
</dd></dl>

<dl class="py class">
<dt id="py_backend.external.External">
<em class="property">class </em><code class="sig-prename descclassname">py_backend.external.</code><code class="sig-name descname">External</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">py_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External" title="Permalink to this definition">¶</a></dt>
<dd><p>Main class of external objects</p>
<dl class="py attribute">
<dt id="py_backend.external.External.py_name">
<code class="sig-name descname">py_name</code><a class="headerlink" href="#py_backend.external.External.py_name" title="Permalink to this definition">¶</a></dt>
<dd><p>The python name of the object</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="py_backend.external.External.missing">
<code class="sig-name descname">missing</code><a class="headerlink" href="#py_backend.external.External.missing" title="Permalink to this definition">¶</a></dt>
<dd><p>What to do with missing values. If “warning” (default)
shows a warning message and interpolates the values.
If “raise” raises an error. If “ignore” interpolates
the values without showing anything.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)">str</a> (“warning”, “error”, “ignore”)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="py_backend.external.External.file">
<code class="sig-name descname">file</code><a class="headerlink" href="#py_backend.external.External.file" title="Permalink to this definition">¶</a></dt>
<dd><p>File name from which the data is read.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="py_backend.external.External.sheet">
<code class="sig-name descname">sheet</code><a class="headerlink" href="#py_backend.external.External.sheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Sheet name from which the data is read.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._col_to_num">
<em class="property">static </em><code class="sig-name descname">_col_to_num</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">col</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._col_to_num"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._col_to_num" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms the column name to int</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>col</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Column name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Column number</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._file_sheet">
<em class="property">property </em><code class="sig-name descname">_file_sheet</code><a class="headerlink" href="#py_backend.external.External._file_sheet" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns file and sheet name in a string</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._fill_missing">
<code class="sig-name descname">_fill_missing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">series</span></em>, <em class="sig-param"><span class="n">data</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._fill_missing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._fill_missing" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills missing values in excel read data. Mutates the values in data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> – the time series without missing values</p></li>
<li><p><strong>data</strong> – the data with missing values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/constants.html#None" title="(in Python v2.7)">None</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._get_data_from_file">
<code class="sig-name descname">_get_data_from_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rows</span></em>, <em class="sig-param"><span class="n">cols</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._get_data_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._get_data_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read data from excel file using rows and columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rows</strong> (<em>list of len 2</em>) – first row and last row+1 to be read, starting from 0</p></li>
<li><p><strong>cols</strong> (<em>list of len 2</em>) – first col and last col+1 to be read, starting from 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – depending on the shape of the requested data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame, pandas.Series or <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._get_data_from_file_opyxl">
<code class="sig-name descname">_get_data_from_file_opyxl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cellname</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._get_data_from_file_opyxl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._get_data_from_file_opyxl" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read data from excel file using cell range name</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cellname</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – the cell range name</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – depending on the shape of the requested data</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray or <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._get_series_data">
<code class="sig-name descname">_get_series_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">series_across</span></em>, <em class="sig-param"><span class="n">series_row_or_col</span></em>, <em class="sig-param"><span class="n">cell</span></em>, <em class="sig-param"><span class="n">size</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._get_series_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._get_series_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Function thar reads series and data from excel file for
DATA and LOOKUPS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series_across</strong> (<em>&quot;row&quot;</em><em>, </em><em>&quot;column&quot;</em><em> or </em><em>&quot;name&quot;</em>) – The way to read series file.</p></li>
<li><p><strong>series_row_or_col</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – <p>If series_across is “row” the row number where the series data is.
If series_across is “column” the column name where</p>
<blockquote>
<div><p>the series data is.</p>
</div></blockquote>
<dl class="simple">
<dt>If series_across is “name” the cell range name where</dt><dd><p>the series data is.</p>
</dd>
</dl>
</p></li>
<li><p><strong>cell</strong> – <dl class="simple">
<dt>If series_across is not “name, the top left cell where</dt><dd><p>the data table starts.</p>
</dd>
</dl>
<p>Else the name of the cell range where the data is.</p>
</p></li>
<li><p><strong>size</strong> – The size of the 2nd dimension of the data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>series, data</strong> – The values of the series and data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray (1D), ndarray(1D/2D)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._initialize_data">
<code class="sig-name descname">_initialize_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">element_type</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._initialize_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._initialize_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize one element of DATA or LOOKUPS</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>element_type</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – “lookup” for LOOKUPS, “data” for data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>data</strong> – Dataarray with the time or interpolation dimension
as first dimension.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._interpolate_missing">
<code class="sig-name descname">_interpolate_missing</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">xr</span></em>, <em class="sig-param"><span class="n">yr</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._interpolate_missing"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._interpolate_missing" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates a list of missing values from _fill_missing</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – list of missing values interpolate</p></li>
<li><p><strong>xr</strong> – non-missing x values</p></li>
<li><p><strong>yr</strong> – non-missing y values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Result after interpolating x with self.interp method</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>y</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._reshape">
<em class="property">static </em><code class="sig-name descname">_reshape</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">dims</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._reshape"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._reshape" title="Permalink to this definition">¶</a></dt>
<dd><p>Reshapes an pandas.DataFrame, pandas.Series, xarray.DataArray
or np.ndarray in the given dimensions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>xarray.DataArray/numpy.ndarray</em>) – Data to be reshaped</p></li>
<li><p><strong>dims</strong> (<em>tuple</em>) – The dimensions to reshape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reshaped array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._resolve_file">
<code class="sig-name descname">_resolve_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">possible_ext</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._resolve_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._resolve_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._series_selector">
<code class="sig-name descname">_series_selector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x_row_or_col</span></em>, <em class="sig-param"><span class="n">cell</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._series_selector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._series_selector" title="Permalink to this definition">¶</a></dt>
<dd><p>Selects if a series data (DATA/LOOKUPS), should be read by columns,
rows or cellrange name.
Based on the input format of x_row_or_col and cell.
The format of the 2 variables must be consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_row_or_col</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – String of a number if series is given in a row, letter if series is
given in a column or name if the series is given by cellrange name.</p></li>
<li><p><strong>cell</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Cell identificator, such as “A1”, or name if the data is given
by cellrange name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>series_across</strong> – “row” if series is given in a row
“column” if series is given in a column
“name” if series and data are given by range name</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.external.External._split_excel_cell">
<code class="sig-name descname">_split_excel_cell</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cell</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/external.html#External._split_excel_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.external.External._split_excel_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits a cell value given in a string.
Returns None for non-valid cell formats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cell</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a>) – Cell like string, such as “A1”, “b16”, “AC19”…
If it is not a cell like string will return None.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>row number, column number</strong> – If the cell input is valid. Both numbers are given in Python
enumeration, i.e., first row and first column are 0.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a>, <a class="reference external" href="https://docs.python.org/2.7/library/functions.html#int" title="(in Python v2.7)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="id0">
<code class="sig-name descname">missing</code><em class="property"> = 'warning'</em><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-py_backend.decorators">
<span id="decorators-used-in-the-model-file"></span><h2>Decorators used in the model file<a class="headerlink" href="#module-py_backend.decorators" title="Permalink to this headline">¶</a></h2>
<p>These are the decorators used by the functions in the model file.
functions.py</p>
<dl class="py class">
<dt id="py_backend.decorators.Cache">
<em class="property">class </em><code class="sig-prename descclassname">py_backend.decorators.</code><code class="sig-name descname">Cache</code><a class="reference internal" href="../_modules/py_backend/decorators.html#Cache"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.decorators.Cache" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the class for the chache. Several cache types can be saved
in dictionaries and acces using cache.data[cache_type].</p>
<dl class="py method">
<dt id="py_backend.decorators.Cache.clean">
<code class="sig-name descname">clean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">horizon</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/decorators.html#Cache.clean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.decorators.Cache.clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Cleans the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>horizon</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#str" title="(in Python v2.7)"><em>str</em></a><em> or </em><em>list of str</em><em> (</em><em>optional</em><em>)</em>) – Name(s) of the cache(s) to clean.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.decorators.Cache.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/decorators.html#Cache.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.decorators.Cache.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets the time to the given one and cleans the step cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<a class="reference external" href="https://docs.python.org/2.7/library/functions.html#float" title="(in Python v2.7)"><em>float</em></a>) – The time to be set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="py_backend.decorators.Cache.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/decorators.html#Cache.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.decorators.Cache.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for caching at a run level</p>
</dd></dl>

<dl class="py method">
<dt id="py_backend.decorators.Cache.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/decorators.html#Cache.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.decorators.Cache.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for caching at a step level</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="py_backend.decorators.subs">
<code class="sig-prename descclassname">py_backend.decorators.</code><code class="sig-name descname">subs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dims</span></em>, <em class="sig-param"><span class="n">subcoords</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/py_backend/decorators.html#subs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#py_backend.decorators.subs" title="Permalink to this definition">¶</a></dt>
<dd><p>This decorators returns the python object with the correct dimensions
xarray.DataArray. The algorithm is a simple version of utils.rearrange</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="complement.html" class="btn btn-neutral float-right" title="Complementary Projects" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="xmile_translation.html" class="btn btn-neutral float-left" title="XMILE Translation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016, James Houghton.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>